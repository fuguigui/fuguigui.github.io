---
title: Model selection
date: 2019-08-08
tags: [complex system, network]
categories: course notes
---

# Objectives

- how **information theoretic concepts** can be used to solve the overfitting problem in community detection.
  - only in community detection? Can it be generalized to other fields?

# Questions

- how is the entropy of a probability mass function defined?
  - H(x)=-\sum_i p(x_i)log p(x_i)
- how is the entropy of a statistical ensemble defined?
  - using the distribution
- What is the entropy of a micro-canonical statistical ensemble? 
  - the log of the microstates number
- how can entropy be used for community detection based on the stochastic block model?
  - define description length and minimize it.
- how is the description length of stochastic block model defined?
  - ![img](http://latex.codecogs.com/svg.latex?H%28M%2Cz%29%3D%5Clog%20Z%28M%2Cz%29%20%3D%20%5Clog%20%5CPi_%7B1%5Cleq%20k%5Cleq%20l%5Cleq%20B%7D%7BN_%7Bkl%7D%5Cchoose%20M_%7Bkl%7D%7D%3D%5Csum_%7B1%5Cleq%20k%5Cleq%20l%5Cleq%20B%7D%5Clog%20P%7BN_%7Bkl%7D%5Cchoose%20M_%7Bkl%7D%7D)
- Explain the basic idea behind flow compression.
  - minimize description length and random walk.
- How is the MapEquation defind? How is it used in InfoMap?
  - L(z) = qH(Q)+\sum_ip_iH(P_i)
  - as a guidance
- How can we calculate the MapEquation for an undirected and unweighted network?
  - stationary probability of edge, 1/m
- How can we generalize InfoMap to directed and weighted network?
  - eigenvectors
- How can we quickly discover a community mapping that minimizes the MapEquation?
  - heuristic algorithms, e.g. simulated annealing, greedy optimization.

# Keywords

- entropy
- description length
- flow compression
- InfoMap

# Entropy

## Definition of Shannon entropy

![img](http://latex.codecogs.com/svg.latex?H%28x%29%3D-%5Csum_%7Bi%7D%20P%28X%3Di%29%5Clog%20P%28X%3Di%29)

- meaning: describe the amount of information needed to know the value of x.
  - the higher H(x) is, the more bit of information, except the x's own distribution, we need to know the value of x.

## Examples

### G(n,p) model

![img](http://latex.codecogs.com/svg.latex?H%28n%2Cp%29%3D-%5Csum_%7Bm%3D1%7D%5E%7B%7B%7Bn%2B1%5Cchoose%202%7D%20%5Cchoose%20m%7D%7D%7B%7Bn%2B1%5Cchoose%202%7D%5Cchoose%20m%7Dp%28n%2Cm%29%5Clog%20p%28n%2Cm%29)

![img](http://latex.codecogs.com/svg.latex?p%28n%2Cm%29%3Dp%5Em%281-p%29%5E%7B%7Bn%2B1%5Cchoose%202%7D-m%7D)

### G(n,m) model

![img](http://latex.codecogs.com/svg.latex?H%28n%2Cm%29%3D-%7B%7Bn%2B1%5Cchoose%202%7D%5Cchoose%20m%7Dp_0%5Clog%20p_0)

![img](http://latex.codecogs.com/svg.latex?p_0%3D%5Cfrac%7B1%7D%7B%7B%7Bn%2B1%5Cchoose%202%7D%5Cchoose%20m%7D%7D)

![img](http://latex.codecogs.com/svg.latex?%5CRightarrow H%28n%2Cm%29%3D-%5Clog%20p_0%3D%5Clog%7B%7Bn%2B1%5Cchoose%202%7D%5Cchoose%20m%7D)

#### Micro-canonical ensemble

- All microstates are equiprobable.

- The entropy of the ensemble is the logarithm of the partition function, i.e. the number of possible microstates.

- the likelihood is simply the inverse of the number of realizations.
  - the smaller the number
  - the larger the likelihood
  - the smaller the entropy
  - MLE = minimize entropy
  
  ![img](http://latex.codecogs.com/svg.latex?H%28%5Ctheta%29%3D%5Clog Z%28%5Ctheta%29)
  
  - ![img](http://latex.codecogs.com/svg.latex?Z%28%5Ctheta%29) is the number of instances.

### stochastic block model

Modify the block matrix M by M_{ij} representing the number of edges between block i and block j, not the probability of edges appearing. Hence, we **change the stochastic block model as a micro-canonical ensemble**.

We have two parameters: M and z. They are independent.

-  N_{kl} are decided by the vector z, the block assignment vector. When we know z, we can know how many nodes in each block and calculate N.
- E_{kl} are decided by the vector z and the topology of the network. We need combine the block assignment of a node and its link to others to count.
- M: note that **not all M and z match** each other. There exists contradiction, e.g. M_{ij} > N_{ij}
- the likelihood is based on three objects:
  - the block matrix M
  - the block assignment vector z
  - the known network (with link information)

![img](http://latex.codecogs.com/svg.latex?H%28M%2Cz%29%3D%5Clog%20Z%28M%2Cz%29%20%3D%20%5Clog%20%5CPi_%7B1%5Cleq%20k%5Cleq%20l%5Cleq%20B%7D%7BN_%7Bkl%7D%5Cchoose%20M_%7Bkl%7D%7D%3D%5Csum_%7B1%5Cleq%20k%5Cleq%20l%5Cleq%20B%7D%5Clog%20P%7BN_%7Bkl%7D%5Cchoose%20M_%7Bkl%7D%7D)

The maximum likelihood given z is

![img](http://latex.codecogs.com/svg.latex?%5Chat%7BH%7D%28z%29%3D%5Csum_%7B1%5Cleq%20k%5Cleq%20l%5Cleq%20B%7D%5Clog%20p%7BN_%7Bkl%7D%5Cchoose%20E_%7Bkl%7D%7D)

# Description length

This is a trade-off between explanatory power and complexity, like AIC (interesting, AIC is also based on the information theory). It works by adding punishment of parameters. The good thing of this criterion is the number can be directly interpreted as bit of information.

## Definition

 ![img](http://latex.codecogs.com/svg.latex?%5Clambda%28z%29%3DH%28z%29%2B%5CDelta%28z%29)

- ![img](http://latex.codecogs.com/svg.latex?%5CDelta%28z%29): the bits of information needed for parameters.

## Example

For stochastic block model, the approximation solution is

![img](http://latex.codecogs.com/svg.latex?%5Clambda%28z%29%3D%5CDelta%28z%29%2Bm%5Ccdot h%28x%29%2Ch%28x%29%3D%281%2Bx%29%5Clog%281%2Bx%29-x%5Clog%28x%29%2C%20x%3D%20%5Cfrac%7BB%28B%2B1%29%7D%7B2m%7D%2Bn%5Ccdot%5Clog%28B%29)

# Flow compression

## Idea

using the cluster to compress the flow description sequence

## Hierarchy coding scheme

## Huffman code

pre-fix coding

## Source coding theorem

the minimum pre-symbol length of lossless code given by Shannon entropy



Hoffman code is asymptotically optimal for n i.i.d symbols with known prob. mass function P

![img](http://latex.codecogs.com/svg.latex?L_n%5Cto%20n%5Ccdot%20H%28p%29)

# MapEquation

## Definition

The minimal code length for mapping nodes to k communities

![img](http://latex.codecogs.com/svg.latex?L%28%5Cvec%7Bz_k%7D%29%3DqH%28Q%29%2B%5Csum_%7Bi%3D1%7D%5Ek%20p_i%20H%28P_i%29)

- q: the per-step probability that random walker switches between communities
- p_i: the per-step probability that random walker switches within community i. 
  - ![img](http://latex.codecogs.com/svg.latex?q%2B%5Csum_%7Bi%3D1%7D%5Ekp_i%3D1)
  - Not  ![img](http://latex.codecogs.com/svg.latex?%5Csum_%7Bi%3D1%7D%5Ekp_i%3D1)
- H(Q): the bits needed to encode clusters.
- H(P_i): the bits needed to encode nodes within cluster P_i

## Example

### undirected and unweighted network

each edge has the same visit probability ![img](http://latex.codecogs.com/svg.latex?%5Cfrac%7B1%7D%7Bm%7D) 

node with degree d_v has the stationary visit probability ![img](http://latex.codecogs.com/svg.latex?%5Cfrac%7Bd_v%7D%7B2m%7D)

so we can get q and p_i

## generalized to directed/weighted network

Instead of using the relative frequencies of links within and across communities, we now actually have to calculate eigenvectors to find the stationary visitation probabilities of nodes and communities.

## Detection algorithms

### InfoMap

find community assignment (with any number of communities) s.t.

![img](http://latex.codecogs.com/svg.latex?%5Chat%7B%5Cvec%7Bz%7D%7D%3D%5Carg_%7B%5Cvec%7Bz%7D%7D%5Cmin%20L%28%5Cvec%7Bz%7D%29)

### Heuristic (to find/to discover) algorithms

#### Simulated annealing

#### Greedy optimization

#### Genetic algorithms

