---
title: Random Walks and Diffusion
date: 2019-07-30
tags: [courses, complex system, network analysis]
categories: Complex Network
---

# Objectives

- topology's influence on dynamical process
- model and analyze diffusion process in complex networks.
- random walk model for diffusion
- Markov chain convergence theorem
- Feedback centrality measures

# Questions

- how is the transition matrix of a random walk defined for weighted and unweighted networks?
  - what is the entry in the transition matrix
  - what is the effect of weight?
  - ![img](http://latex.codecogs.com/svg.latex?T_%7Bij%7D%3D%5Cfrac%7BA_%7Bij%7D%7D%7B%5CSigma_k%20A_%7Bik%7D%7D)
- When does a random walk in a network converge to a unique stationary distribution?
  - the transition matrix: irreducible, aperiodic
- How can we compute the stationary distribution of a random walk?
  - multiply the transition matrix many times enough.
  - calculate the eigenvector corresponding to the eigenvalue1 of the transition matrix.
- How is total variation distance defined? What is its maximum value?
  - the half of the sum of absolute difference in each dimension.
  - 1
- For a right-stochastic transition matrix T and an initial distribution ![img](http://latex.codecogs.com/svg.latex?%5Cpi%5E%7B%280%29%7D), how can we compute the visitation probabilities after t steps of a random walk?
  - ![img](http://latex.codecogs.com/svg.latex?%5Cpi%5E%7B%280%29%7DT%5Et)
- Can you give an example for a network in which a random walk never reaches a stationary distribution?
  - ![img](http://latex.codecogs.com/svg.latex?%5Cpi%5E%7B%280%29%7D%3D%281,0,0%29)
  - ![img](http://latex.codecogs.com/svg.latex?P%281%5Cto2%29%3D1,P%282%5Cto3%29%3D1,P%283%5Cto1%29%3D1)
- Can you give an example for a network in which a random walk reaches multiple stationary distributions for different initial distributions?
  - separated network with many clusters, within each cluster it will reach a stable distribution.
- How can a periodic transition matrix be made aperiodic?
  - add small random values on the diagonal entries.

# Keywords

dynamic process, total variation distance, transition matrix

# Dynamic Process

## Definition

- Dynamic: means the nodes' states changing with **time**. The network topology is **static**.

## Classification

- Four classes:
  - synchronization: the purpose of the common wave length or rhythm is to strengthen the group bond, like homophily. Property's effect on network evolution
    - e.g: people sharing the same culture work together
  - consensus: nodes adopt state of neighbors.  Network evolution's effect on property change.
    - e.g.: opinion formation
  - propagation: a process by which some initial quantities **multiply or proliferate** throughout the network. **Non-conserved quantity**: spreading to others doesn't reduce the original quantity.
    - e.g.: disease broadcast, rumours proliferation. 
  - diffusion:  net movement of anything (e.g., ideas, ions, molecules) from a region of **higher** concentration to a region of **lower** concentration. **Conserved quantity**.
    - e.g.: water, gas, electricity transportation.

# Diffusion process

- the topology's influence
- the role of nodes

## Random Walk 

### Idea

using **probability** to model **lack of knowledge**.

generate **random paths** through a **state space**.

### Markov Chains

If we use the **Markov property** (memoryless) to build random walk, we get **a kind of random walk**, **memoryless Markov process**.

![img](http://latex.codecogs.com/svg.latex?P%28X_%7Bt%2B1%3Ds_%7Bt%2B1%7D%7D%7CX_t%3Ds_t%29)

### Transition Matrix

**A** is the adjacency matrix of the network. We can define transition matrix as 

![img](http://latex.codecogs.com/svg.latex?T_%7Bij%7D%3D%5Cfrac%7BA_%7Bij%7D%7D%7B%5CSigma_k%20A_%7Bik%7D%7D)



- weighted/unweighted is decided by **A**.
- the ![img](http://latex.codecogs.com/svg.latex?T_%7Bij%7D) is normalized, so we can scale out all the outgoing weights of a node without any change of **T**.

#### Row-stochastic/right-stochastic

the row sum of stochastic vector is 1.

**Right** means we multiply **T** at the right side of a vector.

![img](http://latex.codecogs.com/svg.latex?vT)

Here ![img](http://latex.codecogs.com/svg.latex?v%5Cin%5Cmathbb%7BR%7D%5E%7B1%5Ctimes N%7D)

#### Aperiodicity

State i is said to be periodic with period t iff

- ![img](http://latex.codecogs.com/svg.latex?T_%7Bii%7D%5E%7B%28n%29%7D%20%3D%200%2C%5Cforall%20n%5Cneq%20t%2C2t%2C3t%2C%5Ccdots)
- ![img](http://latex.codecogs.com/svg.latex?T_%7Bii%7D%5E%7B%28n%29%7D%20%5Cneq%200%2C%5Cforall%20n%3D%20t%2C2t%2C3t%2C%5Ccdots)

Write in another way

![img](http://latex.codecogs.com/svg.latex?r%28s_i%29%3Dgcd%5C%7Bt%5Cgeq%201%3A%28T%5Et%29_%7Bii%7D%3E0%5C%7D)

- aperiodic: ![img](http://latex.codecogs.com/svg.latex?r%28s_i%29%3D1%2C%5Cforall%20i%5Cin V)
- periodic: otherwise

How to make a matrix aperiodic?

- add small random value on the diagonal items. 
- ![img](http://latex.codecogs.com/svg.latex?T_%7Bii%7D%3D%5Cepsilon%2C%5Cforall%20v%5Cin%20V)
- a random walk with such a transition matrix is called lazy.
- a network with self-loop

#### Irreducibility

Reducible:

![img](http://latex.codecogs.com/svg.latex?%5Cexists%20%28i%2Cj%29%2C%20%5Cdelta%2C%5Cforall%20t%3E%5Cdelta%2C%20%28T%5Et%29_%7Bij%7D%3D0)

Means 

- **strong connectivity** of directed networks.
- connectivity of undirected networks.

#### Markov Chain Convergence theorem

**T**: irreducible and aperiodic

for any initial distribution ![img](http://latex.codecogs.com/svg.latex?%5Cpi%5E%7B%280%29%7D)

![img](http://latex.codecogs.com/svg.latex?%5Cexists|%20%5Cpi%2C%20%5Cdelta%28%5Cpi%5E%7B%28t%29%7D%2C%5Cpi%29%5Cto%200%20%28t%5Cto%20%5Cinfty%29)

the stable distribution is **independent** from the initial distribution.

#### Existence

if there is a **periodic** behavior, the network doesn't have a stationary distribution.

**Lazy**

#### Uniqueness

means for all possible initial distribution, have only one final stable distribution. Requires irreducibility.

Initial Distribution

![img](http://latex.codecogs.com/svg.latex?%5Cpi%5E%7B%280%29%7D%5Cin%5Cmathbb%7BR%7D%5E%7B1%5Ctimes N%7D)

- the sum is 1.
- all entries are non-negative.

![img](http://latex.codecogs.com/svg.latex?%5Cpi%5E%7B%28t%29%7D%3D%5Cpi%5E%7B%280%29%7D%5Ccdot T%5Et)

### Stationary distribution

![img](http://latex.codecogs.com/svg.latex?%5Cpi%5E%7B%28t%29%7D%3D%5Cpi%5E%7B%28t+1%29%7D%5Ccdot 1%3D%5Cpi%5E%7B%28t%29%7D%5Ccdot T)

- the left eigenvector of **T** corresponding to eigenvalue v=1.
- gives a notion of node centrality (feedback centrality).

View from another point:

![img](http://latex.codecogs.com/svg.latex?T%5E%7Bt%7D_%7Bij%7D): the probability of node i goes to node j after t steps. It should be unchanged when t is large enough. That is, there is a t0,

![img](http://latex.codecogs.com/svg.latex?%5Cforall%20t%3Et_0%2C%5Cforall%20k%3E0%2C%20T%5E%7Bt%2Bk%7D_%7Bij%7D%3DT%5Et_%7Bij%7D)

- That means, ![img](http://latex.codecogs.com/svg.latex?T%5E%7Bt%2B1%7D%20%3D%20T%5Et%20%3D%20T%5Et%5Ccdot%20T)Each row of T^t is the eigenvector of T, with the eigenvalue 1.
- The stationary distribution is also the eigenvector of T with the eigenvalue 1.
- Each row of T^t is the same, which is exactly the stationary distribution pi.

#### To network

- undirected network: ![img](http://latex.codecogs.com/svg.latex?%5Cpi_i%3D%5Cfrac%7Bd_i%7D%7B2m%7D)directly related to the node degrees
- directed network: 
  - the number of nodes pointing to  a node
  - the importance of these pointing nodes

## Total Variation distance

![img](http://latex.codecogs.com/svg.latex?%5Cdelta%28%5Cpi_1%2C%5Cpi_2%29%3D%5Cfrac%7B1%7D%7B2%7D%5CSigma_i%7C%5Cpi_%7B1%2Ci%7D-%5Cpi_%7B2%2Ci%7D%7C)

- normalized by 2: to restrict the value less than or equal to 1. The biggest value of the sum of differences for each dimension is 2, with the 1-sum restriction. 
- used to measure if a sequences of vectors converges.

# Others

## Connectivity of directed networks

- strongly connected: all pairs of nodes i,j have a path from i to j and from j to i.
- weakly connected: if the corresponding undirected network is connected.

## Feedback Centrality

![img](http://latex.codecogs.com/svg.latex?%5Cpi%3D%5Cpi%5Ccdot T)

![img](http://latex.codecogs.com/svg.latex?%5Cpi_j%20%3D%20%5CSigma_i%20%5Cpi_iT_%7Bij%7D)

- feedback: the centrality of those nodes that point to a node influence the node's centrality.

- a node that is pointed to by "important" nodes should be "intuitively" more important than those pointed by "unimportant" nodes.

- a node's importance transition on others will be reduced with more outgoing links.

### Zero-indegree

  Since a node's eigenvector(feedback) centrality is determined by its in-going nodes, a node with indegree 0 has 0 centrality.

  **Useless** for **directed acyclic graphs**.

  #### Solution (PageRank)

  assign constant amount of one unit of centrality "for free"

  ![img](http://latex.codecogs.com/svg.latex?%5Calpha%20x%3D%20x%5Ccdot%20T%2B%5Cvec%7B1%7D)

  ![img](http://latex.codecogs.com/svg.latex?x_j%20%3D%20%5Cfrac%7B1%7D%7B%5Calpha%7D%5CSigma_i%20x_i%5Cfrac%7BA_%7Bij%7D%7D%7Bd_%7Bout%7D%28i%29%7D%2B1)

## Eigenvector Centrality

![img](http://latex.codecogs.com/svg.latex?%5Calpha%20x%3D%20x%5Ccdot%20A)

![img](http://latex.codecogs.com/svg.latex?x_j%20%3D%20%5Cfrac%7B1%7D%7B%5Calpha%7D%5CSigma_i%20x_iA_%7Bij%7D)

- ![img](http://latex.codecogs.com/svg.latex?%5Calpha) is the largest eigenvalue of **A**
  - usually, we take the largest one, but not necessarily.
- **T** is replaced by the adjacency matrix **A**. The difference is whether to normalize the degrees. In another way, whether "conserve quantity". 
  - T: conserve
  - A: not conserve
  - The importance of a node will keep even with more outgoing links.

## Centrality comparison

- degree: local measure
- Betweenness, closeness, eigenvector, and PageRank: global characteristics



â€‹	